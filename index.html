<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Free Games Finder</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body {
    background-color: #0b0c10;
    color: #ffffff;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}
header {
    background: linear-gradient(90deg, #1f2833, #45a29e);
    color: #fff;
    padding: 30px 0;
    text-align: center;
    font-size: 2.5rem;
    font-weight: 700;
    box-shadow: 0 4px 6px rgba(0,0,0,0.5);
}
#filters {
    background-color: #1c1f26;
    padding: 20px;
    border-radius: 10px;
    margin: 20px auto;
}
#games {
    display: grid;
    grid-template-columns: repeat(auto-fill,minmax(250px,1fr));
    gap: 20px;
    padding: 20px;
}
.game {
    background-color: #1f2833;
    border-radius: 12px;
    overflow: hidden;
    cursor: pointer;
    transition: transform 0.3s, box-shadow 0.3s;
}
.game:hover {
    transform: scale(1.05);
    box-shadow: 0 8px 16px rgba(0,0,0,0.7);
}
.game img {
    width: 100%;
    height: 160px;
    object-fit: cover;
}
.game-content {
    padding: 12px;
    display: flex;
    flex-direction: column;
    height: 140px;
}
.game-content h5 {
    margin: 0 0 8px 0;
    font-size: 1.2rem;
}
.game-content p {
    flex:1;
    font-size: 0.9rem;
    overflow: hidden;
    text-overflow: ellipsis;
}
.modal-content {
    background-color: #1c1f26;
    color: #fff;
    border-radius: 12px;
}
.modal-header, .modal-footer {
    border:none;
}
.modal-body img {
    width: 100%;
    border-radius: 10px;
    margin-bottom: 15px;
}
.modal a.btn-primary {
    background-color: #45a29e;
    border-color: #45a29e;
}
.modal a.btn-primary:hover {
    background-color: #1f8c7a;
    border-color: #1f8c7a;
}
.loader {
    text-align:center;
    font-size:18px;
    margin:50px 0;
    color:#45a29e;
}
</style>
</head>
<body>

<header>Free Games Finder</header>

<div class="container">
    <div id="filters" class="d-flex flex-wrap justify-content-center gap-2">
        <input type="text" id="searchInput" class="form-control" style="max-width:300px;" placeholder="Search games...">
        <select id="platformSelect" class="form-select" style="max-width:200px;">
            <option value="all">All Platforms</option>
            <option value="pc">PC</option>
            <option value="browser">Browser</option>
        </select>
        <select id="categorySelect" class="form-select" style="max-width:250px;">
            <option value="">All Genres</option>
            <option value="MMO">MMO</option>
            <option value="MMORPG">MMORPG</option>
            <option value="Shooter">Shooter</option>
            <option value="Strategy">Strategy</option>
            <option value="Moba">Moba</option>
            <option value="Card Games">Card Games</option>
            <option value="Racing">Racing</option>
            <option value="Sports">Sports</option>
            <option value="Social">Social</option>
            <option value="Fighting">Fighting</option>
            <option value="MMOFPS">MMOFPS</option>
            <option value="Action RPG">Action RPG</option>
            <option value="Sandbox">Sandbox</option>
            <option value="Open World">Open World</option>
            <option value="Survival">Survival</option>
            <option value="Battle Royale">Battle Royale</option>
            <option value="MMOTPS">MMOTPS</option>
            <option value="Anime">Anime</option>
            <option value="PvP">PvP</option>
            <option value="PvE">PvE</option>
            <option value="Pixel">Pixel</option>
            <option value="MMORTS">MMORTS</option>
            <option value="Fantasy">Fantasy</option>
            <option value="Sci-fi">Sci-fi</option>
            <option value="Action">Action</option>
            <option value="Voxel">Voxel</option>
            <option value="Zombie">Zombie</option>
            <option value="Turn-Based">Turn-Based</option>
            <option value="First Person View">First Person View</option>
            <option value="Third Person View">Third Person View</option>
            <option value="Top-Down View">Top-Down View</option>
            <option value="3D Graphics">3D Graphics</option>
            <option value="2D Graphics">2D Graphics</option>
            <option value="Tank">Tank</option>
            <option value="Space">Space</option>
            <option value="Sailing">Sailing</option>
            <option value="Side Scroller">Side Scroller</option>
            <option value="Superhero">Superhero</option>
            <option value="Permadeath">Permadeath</option>
        </select>
        <select id="sortSelect" class="form-select" style="max-width:200px;">
            <option value="relevance">Relevance</option>
            <option value="popularity">Popularity</option>
            <option value="release-date">Release Date</option>
            <option value="alphabetical">Alphabetical</option>
        </select>
        <button class="btn btn-primary" onclick="resetAndLoadGames()">Search</button>
    </div>

    <div id="games"></div>
</div>

<!-- Modal -->
<div class="modal fade" id="gameModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content p-3">
      <div class="modal-header border-0">
        <h5 class="modal-title" id="modalTitle"></h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <img id="modalImage" src="" alt="">
        <p id="modalDesc"></p>
        <p><strong>Platform:</strong> <span id="modalPlatform"></span></p>
        <p><strong>Genre:</strong> <span id="modalCategory"></span></p>
      </div>
      <div class="modal-footer border-0">
        <a id="modalPlay" href="#" target="_blank" class="btn btn-primary">Play Now</a>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
const RAPIDAPI_KEY = 'e3bbf6ee45mshae51a53c862ca72p1cd1a4jsna02238368745';
const baseUrl = 'https://free-to-play-games-database.p.rapidapi.com/api/games';
let currentPage = 0;
let pageSize = 20;
let loading = false;
let allGames = [];

async function loadGames(page = 0) {
    if(loading) return;
    loading = true;
    const container = document.getElementById('games');
    if(page===0) container.innerHTML='<div class="loader">Loading games...</div>';

    const searchTerm = document.getElementById('searchInput').value.toLowerCase();
    const platform = document.getElementById('platformSelect').value;
    const category = document.getElementById('categorySelect').value;
    const sort = document.getElementById('sortSelect').value;

    let url = baseUrl + '?';
    if(platform !== 'all') url += `platform=${platform}&`;
    if(category) url += `category=${category}&`;

    const options = {
        method:'GET',
        headers:{
            'X-RapidAPI-Key': RAPIDAPI_KEY,
            'X-RapidAPI-Host':'free-to-play-games-database.p.rapidapi.com'
        }
    };

    try {
        const response = await fetch(url, options);
        const data = await response.json();
        allGames = data.filter(g=>g.title.toLowerCase().includes(searchTerm));
        // Sort
        switch(sort){
            case 'alphabetical': allGames.sort((a,b)=>a.title.localeCompare(b.title)); break;
            case 'popularity': allGames.sort((a,b)=>b.freetogame_profile_url?.length - a.freetogame_profile_url?.length); break;
            case 'release-date': allGames.sort((a,b)=>new Date(b.release_date)-new Date(a.release_date)); break;
            default: break;
        }
        displayGames(page);
    } catch(err){
        console.error('Error loading games:',err);
        container.innerHTML='<p style="text-align:center; color:red;">Error fetching games.</p>';
    } finally { loading=false; }
}

function displayGames(page){
    const container = document.getElementById('games');
    if(page===0) container.innerHTML='';
    const start = page*pageSize;
    const end = start+pageSize;
    const gamesToShow = allGames.slice(start,end);
    if(gamesToShow.length===0 && page===0){
        container.innerHTML='<p class="text-center">No games found.</p>';
        return;
    }
    gamesToShow.forEach(game=>{
        const gameDiv=document.createElement('div');
        gameDiv.classList.add('game');
        gameDiv.innerHTML=`<img src="${game.thumbnail}" alt="${game.title}"><div class="game-content"><h5>${game.title}</h5><p>${game.short_description}</p></div>`;
        gameDiv.addEventListener('click',()=>openModal(game));
        container.appendChild(gameDiv);
    });
}

function resetAndLoadGames(){
    currentPage=0;
    allGames=[];
    loadGames(0);
}

function openModal(game){
    document.getElementById('modalImage').src=game.thumbnail;
    document.getElementById('modalTitle').textContent=game.title;
    document.getElementById('modalDesc').textContent=game.description || game.short_description;
    document.getElementById('modalPlatform').textContent=game.platform;
    document.getElementById('modalCategory').textContent=game.genre;
    document.getElementById('modalPlay').href=game.game_url;
    const modal = new bootstrap.Modal(document.getElementById('gameModal'));
    modal.show();
}

// Infinite scroll
window.addEventListener('scroll',()=>{
    if(window.innerHeight + window.scrollY >= document.body.offsetHeight - 500){
        if(!loading && (currentPage+1)*pageSize < allGames.length){
            currentPage++;
            displayGames(currentPage);
        }
    }
});

// Events
document.getElementById('searchInput').addEventListener('input',resetAndLoadGames);
document.getElementById('platformSelect').addEventListener('change',resetAndLoadGames);
document.getElementById('categorySelect').addEventListener('change',resetAndLoadGames);
document.getElementById('sortSelect').addEventListener('change',resetAndLoadGames);

// First load
loadGames(0);
</script>
</body>
</html>
